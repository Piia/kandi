% !TEX root = kandi.tex

\section{Regressiotestaaminen jatkuvassa integraatiossa}

Jatkuvan integraation myötä samaa ohjelmakoodia muokkaavat kymmenet, sadat tai jopa tuhannet ohjelmistokehittäjät ja heidän kaikkien tulee kommitoida tekemänsä muutokset vähintään kerran päivässä \cite{MSB17}. Jatkuvan integraation skaalautuvuudessa regressiotestaaminen muodostaa pullonkaulan \cite{ERP14}. Ohjelmisto on alati muutoksien kohteena ja ohjelmiston toimivuus ja oikeellisuus vaarantuvat joka muutoksessa. Paras tapa ehkäistä virheiden kasaantumista ja isoja rakenteellisia ongelmia on toteuttaa muutokset ja korjata virheet mahdollisimman tiuhaan \cite{HTH+16}.

Regressiotestaamista käytetään koko ohjelmiston toimivuuden ja oikeellisuuden testaamiseen muutoksien jälkeen. Se suoritetaan jatkuvan integraation palvelimella, neutraalissa testiympäristössä. Jatkuvan integraation luonteen vuoksi ohjelmisto regressiotestataan vähintään yhtä monta kertaa kuin ohjelmistolla on kehittäjiä. Ohjelmiston koon ja testien määrän ollessa suuri, regressiotestaamista varten kootaan oma testikokonaisuutensa \cite{ERP14}. Regressiotestaaminen on yleistä, mutta sitä ei käytetä kaikkialla suurten kustannusten vuoksi\cite{LIH17}.

Testitoimintojen toimivuus ja sujuvuus on iso osa jatkuvan integraation toimimista ja ohjelmistokehittäjien kokemaa tyytyväisyyttä jatkuvaan integraatioon. \cite{MSB17} Ohjelmistokehitystiimi ei voi työskennellä luotettavasti rikkinäisen ohjelmiston parissa. Siispä jatkuvan integraation palvelimen antama palaute testien läpäisystä toimii vakuutena koko ohjelmistokehitystiimille, että työtä voi jatkaa rauhassa ja se rakentuu toimivan kokonaisuuden päälle. Uudet virheet voidaan paikantaa muutoksen tarkkuudella, eikä kenenkään työtä sotketa turhaan. Testaaminen muuttuu aina vain tärkeämmäksi sitä mukaa, kun lähestytään julkaisua \cite{ERP14}. Jatkuvan integraation palvelimen on tarkoitus tuottaa puolueeton ja luotettava testitulos, joka vertautuu ohjelmiston käyttämiseen oikeissa tuotanto-olosuhteissa. \cite{Fow06} 

Regressiotestaamista varten muodostetaan oma testikokonaisuus, sillä testipohjan koko on miltei aina liian suuri suoritettavaksi joka integraatiolla. Yleisimmät tavat muodostaa testikokonaisuus on rajaaminen ja priorisointi. Testikokonaisuuden rajaamisessa kokonaisuus muodostetaan testeistä, jotka tuottavat eniten kulloinkin hyödyllistä tietoa. Koodipohjasta voidaan jokaisen kommitin perusteella tehdä riippuvuusanalyysi, joka paljastaa, mihin muutos vaikuttaa. Kokonaisuuden rajaamista helpottaa ohjelmiston modulaarinen, eli osista muodostuva rakenne, jossa jokainen osa kootaan itsenäisesti. Näin voidaan testaaminen voidaan suorittaa rinnakkain. Testikokonaisuuden priorisoimisella pyritään nopeuttamaan regressiotestaamisesta saatavaa palautetta. Jatkuvan integraation palvelimelta saatava palaute on tärkeä osa jatkuvaa integraatiota \cite{ERP14}.


\subsection{Kustannukset}

Jatkuvan integraation käyttö on kustannustehokkaampaa kuin integraatio erillisenä tuotantovaiheena. Tämä johtuu pitkälti ohjelmistotuotantoprosessin läpinäkyvyyden kasvusta, kun ohjelmistoon syntyneet virheet saatetaan koko ohjelmistokehitystiimin tietoon. Pieniä virheitä on suuria virheitä nopeampi korjata, mikä vähentää kuluvia työtunteja ja ehkäisee aikataulun venymistä. Näin ehkäistään myös rikkonaisen ikkunan syndroomaa, eli ohjelmistokehittäjien taipumusta vältellä suurien virheiden korjaamista \cite{SB13}. Tuotantoon asti ehtineet virheet ovat erityisen kalliita, sillä uudet käyttäjät eivät pidä virheistä sen enempää kuin vanhat käyttäjätkään \cite{LIH17}. Hyvä esimerkki tästä on Pokemon Go -mobiilipeli, joka saavutti maailmanlaajuisen suosion, mutta käyttäjät kyllästyivät nopeasti pelaamista vaikeuttaviin virheisiin.

Regressiotestaamisella pyritään estämään virheiden muodostuminen ja nopeuttamaan niiden löytymistä, mutta sen käyttämisen kustannukset eivät saa nousta hyötyjä korkeammiksi. Ohjelmistokehittäjien on koettava, että heidän ponnistelunsa testien kirjoittamisen ja testipohjan ylläpitämisen parissa on sen arvoista \cite{LIH17}. Regressiotestaamisen kustannukset ovat omaa luokkaansa, koska koodipohjat ovat isoja. Niissä on paljon riippuvuuksia ja moduuleita, jotka voivat olla tahoillaan kehitettävinä ja siten aiheuttaa tarpeettomia epäonnistumisia testaamisessa. Ongelmat vähenevät, kun ohjelmistokehittäjät testaavat koodia riittävästi ennen kommitointia. Toisaalta kuten luvussa 2.2 mainittiin, ennen kommitointia tapahtuvasta testaamisesta ei saa muodostua ohjelmistokehitykseen pullonkaulaa. Näin tapahtuu, jos ohjelmistokehittäjä ei uskalla kommitoida koodia ja testaa sitä liikaa. Työajan kulumisen lisäksi liiallinen testaaminen kuluttaa mahdollisen testipalveliman kapasitettia \cite{ERP14}. 

Jatkuvan integraation skaalautuvuudessa regressiotestaaminen muodostaa pullonkaulan. Koodipohjan, testipohjan ja kommitoinnin määrä kasvavat ja resurssit sitä mukaan hupenevat. Resurssit kuluvat myös liiallisessa kommitointia edeltävässä testaamisessa \cite{ERP14}. Ohjelmiston kokoaminen ja regressiotestaaminen voi johtaa palvelinresurssien riittämättömyyteen. Regressiotestaaminen kuluttaa yhtä paljon työaikaa kuin varsinainen ohjelmiston kehittäminen, sillä regressiotestien tekeminen ja testipohjan ylläpitäminen vie aikaa. Se on paljon, sillä regressiotestaaminen on vain yksi osa ohjelmiston testaamista \cite{MGN+17}.

Eräässä tutkimuksessa mitattiin kolmen ja puolen vuoden aikana javaprojektien koodi- ja testipohjan kasvua. Jakson aikana testipohjan koko on kaksinkertaistunut, samalla kun koodipohja on kasvanut vain puolella \cite{LIH17}. Kehitys näkyy kuvassa \ref{koodipohja}. Suuri koodipohja vaikeuttaa perinteisten testikokoelman käyttämiseen käytettyjen tekniikoiden käyttämistä, sillä ne perustuvat erilaisten analyysityökalujen käyttöön. Koodipohjan kasvu tekee analyysityökaluista raskaita käyttää  \cite{ERP14}.

\begin{figure}[h]
    \centering
    \includegraphics[width=\textwidth]{koodipohja.pdf}
    \caption{Testipohjan osuus koodipohjasta kasvaa ajan myötä. \cite{LIH17}}
    \label{koodipohja}
\end{figure}

Ohjelmiston lisäksi myös testeissä itsessään voi olla virheitä, joiden tunnistaminen ja korjaaminen voi olla hankalaa. \cite{LIH17} Testitoiminnot voi myös rakentaa osin ulkopuolisen palveluntarjoajan palveluiden varaan, mutta tällöin testejä voi joutua muuttamaan jokaisen palveluntarjoajan tekemän muutoksen myötä. Regressiotestaamisen kustannukset on otettava tarkasti huomioon laskettaessa jatkuvan integraation kustannuksia. \cite{HTH+16}- KATSO PROSENTIT FAILEISTA \cite{LIH17}

Testikokonaisuuden valinnalla on iso vaikutus regressiotestaamisen kustannustehokkuuteen. Projektikohtaiset hyötyjen ja haittojen tutkiminen kannattaa. Samaten koontiversioiden tasolla tehty tarkastelu erilaisten epäonnistumien syistä ja suhteista \cite{LIH17}. Testikokonaisuuden rajaaminen ja testikokonaisuuden priorisointi ovat käytetyimmät tekniikat, mutta sellaisenaan ne sopivat jatkuvan integraation kontekstissa huonosti, sillä niiden käyttö perustuu analysointityökaluihin, joiden soveltaminen suureen koodipohjaan on liian raskasta. Testikokonaisuuksien kustannustehokkuutta voi kasvattaa strategialla, jossa yhdistellään näitä tekniikoita. Isoin parannus saadaan aikaan sillä, että ennen kommitointia suoritettavassa testaamisessa rajataan testikokonaisuuksia aikaikkuna-historiadata-menetelmällä. Kommitoinnin jälkeen sen sijaan priorisointi parantaa merkittävästi hyödyllisen palautteen saamisaikoihin \cite{ERP14}. 


\clearpage