% !TEX root = kandi.tex


\section{Regressiotestaaminen}

Jatkuvan integraation myötä samaa ohjelmakoodia muokkaavat kymmenet, sadat tai jopa tuhannet ohjelmistokehittäjät ja heidän kaikkien tulee kommitoida tekemänsä muutokset vähintään kerran päivässä. \cite{MSB17} Ohjelmisto on alati muutoksien kohteena ja ohjelmiston toimivuus ja oikeellisuus vaarantuvat joka muutoksessa. Paras tapa ehkäistä virheiden kasaantumista ja isoja rakenteellisia ongelmia on toteuttaa muutokset ja korjata virheet mahdollisimman tiuhaan.\cite{HTH+16}

Regressiotestaamista käytetään koko ohjelmiston toimivuuden ja oikeellisuuden testaamiseen muutoksien jälkeen. Ohjelmiston koko ja testien määrä on yleensä suuri, joten ei ole missään määrin järkevää, että kaikki ohjelmiston parissa työskentelevät ohjelmistokehittäjät ajaisivat kaikki olemassaolevat testit päivittäin. Tämän vuoksi regressiotestaamista varten kootaan erikseen testikokonaisuus. Regressiotestaaminen suoritetaan jatkuvan integraation palvelimella neutraalissa testiympäristössä. \cite{ERP14} Jatkuvan integraation palvelimen on tarkoitus tuottaa puolueeton ja luotettava testitulos, joka vertautuu ohjelmiston käyttämiseen oikeissa tuotanto-olosuhteissa. \cite{Fow06}

Testitoimintojen toimivuus on iso osa jatkuvan integraation toimimista ja ohjelmistokehittäjien kokemaa tyytyväisyyttä jatkuvaan integraatioon. \cite{MSB17} Ohjelmistokehitystiimi ei voi työskennellä luotettavasti rikkinäisen ohjelmiston parissa. Siispä jatkuvan integraation palvelimen antama palaute testien läpäisystä toimii vakuutena koko ohjelmistokehitystiimille, että työtä voi jatkaa rauhassa ja se rakentuu toimivan kokonaisuuden päälle. Uudet virheet voidaan paikantaa muutoksen tarkkuudella, eikä kenenkään työtä sotketa turhaan. \cite{ERP14} 


\subsection{Testikokonaisuuden muodostaminen}

Jatkuvan integraation testitoiminnot voidaan jakaa karkeasti kahteen luokkaan: testaaminen ennen kommitointia ja kommitoinnin jälkeen. Kommitoinnin jälkeen tapahtuvalla testaamisella tarkoitetaan jatkuvan integraation palvelimella tapahtuvaa testaamista. Projektista riippuen kommitointia edeltävä testaaminen voi tapahtua ohjelmistokehittäjän työkoneella tai erillisellä testipalvelimella. Ohjelmistokehittäjän on testattava työnsä ennen integraatiota välttääkseen turhaan rikkomasta yhteistä ohjelmakoodia. \cite{ERP14}

Integraatiotesteillä testataan sisäisesti ohjelmiston eri osien yhteensopivuus. Järjestelmätesteillä ajetaan ulkoisesti testitapauksia, jotka on tehty ohjelmistolle asetettujen vaatimuksien pohjalta. Järjestelmätesteillä saadaan selville ohjelmiston oikeellisuus. Regressiotestien ei tarvitse testata yksikkötesteillä uudelleen yksittäisiä koodinpätkiä, sillä ohjelmistokehittäjät testaavat työnsä huolellisesti työkoneellaan ennen integraatiota. Siitä huolimatta testikokonaisuuteen voidaan lisätä ohjelmiston toimivuuden kannalta tärkeitä yksikkötestejä.

Yleisimmät tekniikat testikokonaisuuden muodostamisessa ovat kokonaisuuden minimointi, sopivien testien valinta ja testien ajojärjestyksen priorisointi. Eri tekniikoita voi käyttää testikokonaisuuden muodostamisessa tai niitä voi jopa vaihdella testiajokerroilla. Esimerkiksi käyttäytymiseen perustuva regressiotestaaminen (behavioral regression testing) on menetelmä, jolla ohjelmistokehittäjien valitsemien regressiotestien lisäksi käytetään itsestään generoituvia testejä. Näin pyritään varmistamaan ohjelmiston oikeellisuuden lisäksi myös sitä, että oikeellisuus syntyy tarkoitetulla tavalla.

Testikokonaisuuden minimointi edellyttää varmuutta siitä, että minimoitu testikokonaisuus todella riittää ohjelmiston testaamiseen ja virheiden löytämiseen. Eräs minimointimenetelmä on tarkastella muutoksen vaikuttavuutta ohjelmistossa ja testata vain näitä osia. 

Testikokonaisuuden muodostaminen valinnalla voidaan toteuttaa käsin tai ohjelmallisesti. Kummallakin menetelmällä on tarkoitus valita asiantuntemuksen perusteella relevanteimmat testit.

Testien priorisoiminen tarkoittaa sitä, että valitaan mitkä testitapaukset ajetaan ensin. Näin testaamisesta syntyvä palaute saadaan nopeammin tärkeistä testeistä ja palaute saadaan silloinkin, kun ohjelmiston testaaminen keskeytyy esimerkiksi virheen tai muistin loppumisen myötä. Testitapausten priorisointijärjestys tulee suoraan ohjelmiston vaatimusten priorisointijärjestyksestä. 



\subsection{Historiatietojen kerääminen}

Erilaisia historiatietoja voi käyttää testikokonaisuuden muodostamisen tukena tai pohjana. Esimerkiksi toistuvasti hylkäävien testien voidaan olettaa testaavan ohjelmiston hauraita osia, jolloin jatkossa niitä testejä voidaan ajaa useammin. Samoin jatkuvasti läpi menevät testit voivat olla turhia ja niitä ei tarvitse ajaa joka integraatiossa. 

Testidatan kulkureitistä ja läpikäymistä prosesseista kerättävä metadata (provenance data) on monikäyttöistä. Metadatan keräämisestä ja analysoimisesta on hyötyä regressiotestaamisen optimoinnissa ja lisäksi tekniikkaa käytetään tieteellisissä kokeissa. Metadataa kerätään yleensä joko tarkoituksena tuottaa tietoa tulevaa testaamista varten tai yksityiskohtia edellisistä testiajoista. 

Sekä testiajojen historiasta että metadatan analysoimisesta voi muodostaa parempaa palautetta ohjelmistokehittäjille. Esimerkiksi ohjelmistokehittäjä voisi saada tilastotietoja omista integraatioistaan ja yksityiskohtaisia kehitysehdotuksia parantamaan integraatioiden onnistumisprosenttia. Lisäksi integraation onnistumiseen ja epäonnistumiseen liittyvien tekijöiden tunnistaminen tehostaa ohjelmistokehitystä. 



\subsection{Kustannukset}

Regressiotestaamisella pyritään ohjelmiston laadun kasvuun ja ohjelmistokehityksen kustannusten vähentämiseen. Regressiotestaamista rajoittavat palvelin- ja henkilöresurssit. Kuten edellisessä luvussa todettiin, kaikkia mahdollisia testejä ei ole yleensä mahdollista tai järkevää ajaa jokaisessa integraatiossa, minkä vuoksi regressiotestaamista varten muodostetaan oma testikokonaisuus. 


Jatkuva integraatio on kustannustehokkaampi kuin integraatio erillisenä tuotantovaiheena. Jatkuva integraatio lisää ohjelmistotuotantoprosessin läpinäkyvyyttä, kun ohjelmistoon syntyneet virheet tulevat heti koko ohjelmistokehitystiimin tietoon. Pienet virheet ovat nopeampia korjata kuin suuret, mikä vähentää työtunteja ja ehkäisee aikataulun venymistä. Virheiden huomaaminen ennen niiden paisumista isoiksi ongelmiksi ehkäisee rikkonaisen ikkunan syndroomaa, eli ohjelmistokehittäjien taipumusta olla tarttumatta liian suuriin ongelmiin. \cite{SB13}

Jatkuva ohjelmiston kokoaminen ja testien ajaminen voi johtaa palvelinresurssien riittämättömyyteen. \cite{MGN+17} Toisaalta testitoimintojen ylläpitämiseenkin kuluu työaikaa. Pelkästään regressiotestien kehittämiseen ja ylläpitoon voi kulua yhtä paljon työaikaa kuin itse ohjelmakoodin kirjoittamiseen ja regressiotestaaminen on vain yksi osa ohjelmiston testaamista. Ohjelmiston lisäksi myös testeissä itsessään voi olla virheitä, joiden tunnistaminen ja korjaaminen voi olla hankalaa. \cite{LIH17} Testitoiminnot voi myös rakentaa osin ulkopuolisen palveluntarjoajan palveluiden varaan, mutta tällöin testejä voi joutua muuttamaan jokaisen palveluntarjoajan tekemän muutoksen myötä. \cite{HTH+16}

Jatkuva ohjelmiston kokoaminen ja testien ajaminen voi johtaa palvelinresurssien riittämättömyyteen. Esimerkiksi Googlen testipalvelimella ajetaan päivittäin 800 000 integraatiota. Siellä resurssien riittämättömyys on ratkaistu niin, että palvelin kokoaa ja testaa 45 minuutin välein kertyneet kommitit. Iso osa ajetuista testeistä meni aina läpi, joten niitä päätettin ajaa harvemmin. 





\clearpage


